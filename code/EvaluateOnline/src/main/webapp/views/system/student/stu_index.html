<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">

    <title>在线测评系统 | 学生端</title>

    <meta name="keywords" content="">
    <meta name="description" content="">

    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
	<link rel="shortcut icon" href="../../../static/system/admin/img/favicon.ico"> 
    <link href="../../../static/modules/plugin/bootstrap/bootstrap.min.css?v=3.3.6" rel="stylesheet">
	<link href="../../../static/modules/plugin/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
	<link href="../../../static/modules/plugin/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
	<link href="../../../static/modules/plugin/animate/animate.css" rel="stylesheet">
	<link href="../../../static/system/admin/css/style.css?v=4.1.0" rel="stylesheet">
	<style>
		.inplabel {
			text-align: right;
		}
		.modal-body {
			height: 172px;
		}
		.form-group {
			height: 35px;
			line-height: 35px;
			width: 130%;
		}
		.alert {
			position: fixed;
			width: 50%;
			top: 10px;
			left: 25%;
			z-index: 1111;
		}
		.username {
			font-size: 18px;
			margin-right: 10px;
			position: relative;
			top: -2px;
		}
		.nav-header {
			padding-left: 10px;
		}
	</style>
</head>

<body class="fixed-sidebar full-height-layout gray-bg" style="overflow:hidden">
    <div id="wrapper">
        <!--左侧导航开始-->
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="nav-close"><i class="fa fa-times-circle"></i>
            </div>
            <div class="sidebar-collapse">
                <ul class="nav" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element">
                        	<!-- START提示信息 -->
                        	<div style="display: none;" class="alert alert-success alert-dismissable" id="success">
						        <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
						        用户修改密码添加成功 
						    </div>
                        	<div class="alert alert-danger alert-dismissable" id="fail"  style="display: none;">
						        <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
						        用户修改密码失败！ 
						    </div>
						    <!-- END提示信息 -->
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="clear">
                                    <span class="block m-t-xs" style="font-size:20px;">
                                        <img style="width: 35px;" src="../../../static/system/admin/img/havetext.png">
                                        <strong class="font-bold">学生端</strong>
                                    </span>
                                </span>
                            </a>
                        </div>
                        <div class="logo-element">学生端</div>
                    </li>
                    <li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
                        <span class="ng-scope">分类</span>
                    </li>
                    <li>
                        <a class="J_menuItem" href="./courseManage">
                            <i class="fa fa-home"></i>
                            <span class="nav-label">主页</span>
                        </a>
                    </li>
                    <li>
                        <a class="J_menuItem" href="./CourseWithQuestion">
                            <i class="fa fa fa-book"></i>
                            <span class="nav-label">实验管理</span>
                            
                        </a>
                        
                    </li>
                </ul>
            </div>
        </nav>
        <!--左侧导航结束-->
        <!--右侧部分开始-->
        <div id="page-wrapper" class="gray-bg dashbard-1">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-info " href="#"><i class="fa fa-bars"></i></a>
                        <form role="search" class="navbar-form-custom" method="post" action="search_results.html">
                            <div class="form-group">
                                <!-- <input type="text" placeholder="请输入您需要查找的内容 …" class="form-control" name="top-search" id="top-search"> -->
                            </div>
                        </form>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li class="dropdown">
                            <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                                <!-- <i class="fa fa-sign-out fa-lg"></i>  -->
                                <span class="username">#(session.student.name)&nbsp;&nbsp;同学</span>
                                <i class="fa fa-user-circle-o" aria-hidden="true" style="font-size: 23px;"></i> 
                            </a>
                            <ul class="dropdown-menu dropdown-messages">
                                <li class="m-t-xs">
                                    <div class="dropdown-messages-box">
                                        <div class="media-body" data-toggle="modal" data-target="#updateModal">
                                            <strong>修改</strong> 
                                        </div>
                                    </div>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <div onclick="logout()" class="dropdown-messages-box">
                                        <div class="media-body ">
                                            <strong>退出</strong> 
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        
                    </ul>
            </div>     
           
           
            <div class="row J_mainContent" id="content-main">
                <iframe id="J_iframe" width="100%" height="100%" src="./courseManage" frameborder="0" data-id="stu_course.html" seamless></iframe>
            </div>
        </div>
        <!--右侧部分结束-->
    </div>
	 <!-- 模态框（Modal） -->
	<div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	    <div class="modal-dialog">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	                <h4 class="modal-title" id="myModalLabel">修改用户密码</h4>
	            </div>
	            <div class="modal-body">
	            	<div class="form-group">
                        <label class="col-sm-3 col-md-3 control-label inplabel">密码:</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="password" name="oldpsd" id="oldpsd" class="form-control input" onblur="checkOldpsd()">
                        	<span style="display: none;" id="oldpsdError" class="error">密码错误</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 col-md-3 control-label inplabel">新密码:</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="password" name="newpsd" id="newpsd" class="form-control input"  onblur="checkNewpsd()">
                       		<span style="display: none;" id="newpsdError" class="error">5-12位字母/数字</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 col-md-3 control-label inplabel">确认密码:</label>
                        <div class="col-sm-9 col-md-9">
                            <input type="password" name="repsd" id="repsd" class="form-control input" onblur="checkRepsd()" >
                        	<span style="display: none;" id="repsdError" class="error">两次输入密码不一致</span>
                        </div>
                    </div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
	                <button type="button" class="btn btn-primary" onclick="updatePsd()">提交更改</button>
	            </div>
	        </div><!-- /.modal-content -->
	    </div><!-- /.modal -->
	</div>
	
    <!-- 全局js -->
    <script src="../../../static/modules/plugin/jquery/jquery.min.js?v=2.1.4"></script>
    <script src="../../../static/modules/plugin/bootstrap/bootstrap.min.js?v=3.3.6"></script>
    <script src="../../../static/modules/plugin/metisMenu/jquery.metisMenu.js"></script>
    <script src="../../../static/modules/plugin/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="../../../static/modules/plugin/layer/layer.min.js"></script>

    <!-- 自定义js -->
    <script src="../../../static/system/admin/js/hAdmin.js?v=4.1.0"></script>
    <script type="text/javascript" src="../../../static/system/admin/js/index.js"></script>

    <!-- 第三方插件 -->
    <script src="../../../static/modules/plugin/pace/pace.min.js"></script>	 <script>
    var result = false;
    //检验旧密码
        function checkOldpsd(){
        	var oldpsd = $("#oldpsd").val();
        	if(oldpsd != null && "" != oldpsd){
        		$.ajax({
        			type: "post",
        			url: "/student/checkPass",
        			dataType: "JSON",
        			data:{ oldpsd: oldpsd },
        			success: function(response){
        				if(response.code == 1){
        					$("#oldpsdError").hide();
        					result = true;
        				}else{
        					$("#oldpsdError").show();
        					result = false;
        				}
        			}
        		})
        	}else{
        		$("#oldpsdError").show();
        		result = false;
        	}
        }
        //检验新密码
        function checkNewpsd(){
        	var newpsd = $("#newpsd").val();
        	//5-12位字母或数字
        	var reg = /^[a-z0-9A-Z]{5,12}$/;
        	if(reg.test(newpsd)){
        		$("#newpsdError").hide();
        		return true;
        	}else{
        		$("#newpsdError").show();
        		return false;
        	}
        }
    	//检查第二次输入密码
    	function checkRepsd(){
    		var newpsd = $("#newpsd").val();
    		var repsd = $("#repsd").val();
    		if(repsd == newpsd){
    			$("#repsdError").hide();
    			return true;
    		}else{
    			$("#repsdError").show();
    			return false;
    		}
    	}
    	//保存修改
    	function updatePsd(){
    		var newpsd = $("#newpsd").val();
    		if(result && checkNewpsd() && checkRepsd()){
    			$.ajax({
    				type:"post",
    				url:"/student/updatePassword",
    				dataType: "JSON",
        			data:{ newpsd: newpsd },
        			success: function(response){
        				if(response.code == 1){
        					//修改成功
        					$("#updateModal").modal('hide');
        					$("#success").show();
        					setTimeout(function(){$("#success").hide();},2000);
        				}else{
        					//修改失败
        					$("#updateModal").modal('hide');
        					$("#fail").show();
        					setTimeout(function(){$("#fail").hide();},2000);
        				}
        			}
    			});
    		}
    	}
        // 登出
        function logout(){
            window.location.href = "/student/logout";
        }

    </script>
</body>

</html>